{"version":3,"sources":["rainBowGameLogic.js"],"names":["global","require","EventListener","COLORPOINTS","cc","Class","extends","Component","properties","rainPrefab","default","type","Prefab","serializable","onLoad","winSize","director","getWinSize","curFillingRainBow","touchedColor","fillProgress","lastTime","start","world","find","self","eventlistener","on","colorId","fillRainBow","updateProgress","progress","getChildByName","bar","getComponent","ProgressBar","generatorRain","randXOffset","random0To1","width","yOffset","height","rain","instantiate","setPosition","addChild","update","dt","date","Date","sec","getTime"],"mappings":";;;;;;AAAA,IAAIA,SAASC,QAAQ,UAAR,CAAb;AACA,IAAIC,gBAAgBD,QAAQ,kBAAR,CAApB;AACA,IAAIE,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,GAAb,EAAiB,GAAjB,EAAqB,GAArB,EAAyB,GAAzB,CAAlB;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAY;AACR;AACAC,qBAAS,IAFD,EAEc;AACA;AACtBC,kBAAMP,GAAGQ,MAJD,EAIS;AACjBC,0BAAc,IALN,CAKc;AALd;AAOZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfQ,KAHP;;AAqBL;;AAEAC,UAvBK,oBAuBK;AACN,aAAKC,OAAL,GAAeX,GAAGY,QAAH,CAAYC,UAAZ,EAAf;AACA,aAAKC,iBAAL,GAAyB,CAAzB;AACA,aAAKC,YAAL,GAAoB,EAApB;AACA,aAAKC,YAAL,GAAoB,CAApB;AACA,aAAKC,QAAL,GAAgB,CAAhB;AACH,KA7BI;AA8BLC,SA9BK,mBA8BI;AACL,aAAKC,KAAL,GAAanB,GAAGoB,IAAH,CAAQ,QAAR,CAAb;AACA,YAAIC,OAAO,IAAX;AACAzB,eAAO0B,aAAP,CAAqBC,EAArB,CAAwB,aAAxB,EAAsC,UAASC,OAAT,EAAiB;AACnDH,iBAAKI,WAAL,CAAiBD,OAAjB;AACH,SAFD;AAGH,KApCI;;AAqCLC,iBAAY,qBAASD,OAAT,EAAiB;AACzB,YAAIA,WAAW,KAAKV,iBAApB,EAAsC;AAClC,iBAAKE,YAAL,IAAqB,IAAEjB,YAAY,KAAKe,iBAAL,GAAyB,CAArC,CAAvB;AACA,iBAAKY,cAAL,CAAoBF,OAApB,EAA4B,KAAKR,YAAjC;AACA,gBAAG,KAAKA,YAAL,IAAoB,CAAvB,EAAyB;AACrB,oBAAI,KAAKF,iBAAL,IAA0B,CAA9B,EAAgC;AAC5B,yBAAKA,iBAAL,IAAyB,CAAzB;AACH,iBAFD,MAEK;AACD;AACH;AACJ;AACJ,SAVD,MAUK,CAEJ;AACJ,KAnDI;AAoDLY,oBAAe,wBAASF,OAAT,EAAiBR,YAAjB,EAA8B;AACzC,YAAIW,WAAW,KAAKR,KAAL,CAAWS,cAAX,CAA0B,YAAYJ,OAAtC,CAAf;AACA,YAAIK,MAAMF,SAASG,YAAT,CAAsB9B,GAAG+B,WAAzB,CAAV;AACAF,YAAIF,QAAJ,GAAeX,YAAf;AACH,KAxDI;AAyDLgB,mBAAc,yBAAU;AACpB,YAAIC,cAAcjC,GAAGkC,UAAH,MAAmB,KAAKvB,OAAL,CAAawB,KAAb,GAAqB,EAAxC,IAA8C,KAAKxB,OAAL,CAAawB,KAAb,GAAmB,CAAnF;AACA,YAAIC,UAAU,KAAKzB,OAAL,CAAa0B,MAAb,GAAoB,CAApB,GAAwB,GAAtC;AACA,YAAIC,OAAOtC,GAAGuC,WAAH,CAAe,KAAKlC,UAApB,CAAX;AACAiC,aAAKE,WAAL,CAAiBP,WAAjB,EAA6BG,OAA7B;AACA,aAAKjB,KAAL,CAAWsB,QAAX,CAAoBH,IAApB;AACH,KA/DI;AAgELI,UAhEK,kBAgEGC,EAhEH,EAgEO;AACR,YAAIC,OAAO,IAAIC,IAAJ,EAAX;AACA,YAAIC,MAAMF,KAAKG,OAAL,EAAV;AACA,YAAID,MAAM,KAAK7B,QAAX,GAAsB,GAA1B,EAA8B;AAC1B,iBAAKA,QAAL,GAAgB6B,GAAhB;AACA,iBAAKd,aAAL;AACH;AACJ;AAvEI,CAAT","file":"rainBowGameLogic.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["var global = require(\"./global\");\nvar EventListener = require(\"./event-listener\");\nvar COLORPOINTS = [100,120,140,160,180,200,250]\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        rainPrefab: {\n            // ATTRIBUTES:\n            default: null,        // The default value will be used only when the component attaching\n                                  // to a node for the first time\n            type: cc.Prefab, // optional, default is typeof default\n            serializable: true,   // optional, default is true\n        },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.winSize = cc.director.getWinSize()\n        this.curFillingRainBow = 1\n        this.touchedColor = \"\"\n        this.fillProgress = 0\n        this.lastTime = 0\n    },\n    start () {\n        this.world = cc.find(\"Canvas\")\n        var self = this\n        global.eventlistener.on(\"collectRain\",function(colorId){\n            self.fillRainBow(colorId)\n        })\n    },\n    fillRainBow:function(colorId){\n        if (colorId == this.curFillingRainBow){\n            this.fillProgress += 1/COLORPOINTS[this.curFillingRainBow - 1]\n            this.updateProgress(colorId,this.fillProgress)\n            if(this.fillProgress >=1){\n                if (this.curFillingRainBow != 7){\n                    this.curFillingRainBow +=1\n                }else{\n                    //game Over\n                }\n            }\n        }else{\n\n        }\n    },\n    updateProgress:function(colorId,fillProgress){\n        var progress = this.world.getChildByName(\"rainbow\" + colorId)\n        var bar = progress.getComponent(cc.ProgressBar)\n        bar.progress = fillProgress\n    },\n    generatorRain:function(){\n        var randXOffset = cc.random0To1() * (this.winSize.width - 50) - this.winSize.width/2\n        var yOffset = this.winSize.height/2 + 200\n        var rain = cc.instantiate(this.rainPrefab)\n        rain.setPosition(randXOffset,yOffset)\n        this.world.addChild(rain)\n    },\n    update (dt) {\n        var date = new Date()\n        var sec = date.getTime()\n        if (sec - this.lastTime > 300){\n            this.lastTime = sec\n            this.generatorRain()\n        }\n    },\n});\n"]}