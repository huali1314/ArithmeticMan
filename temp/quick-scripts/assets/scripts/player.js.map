{"version":3,"sources":["player.js"],"names":["global","require","cc","Class","extends","Component","properties","onLoad","world","find","bg","getChildByName","question1","question2","winSize","director","getWinSize","animation","node","getComponent","Animation","setLocalZOrder","start","self","initPlayerPos","eventlistener","on","runPrepareAction","forward","runForwardOrBackAction","right","runLeftOrRightAction","setPosition","width","height","player_x","x","anim1","moveTo","spawn","callFunc","play","sequence","fire","runAction","x_offset","y_offset","y","direction_x_offset","action","moveBy","scaleAction","scaleBy","reverse","action1","spawn1","scaleX","action2","spawn2","sequence1"],"mappings":"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","file":"player.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\nvar global = require(\"./global\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // player: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type:cc.Prefab, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        var world = cc.find(\"Canvas\")\n        var bg = world.getChildByName(\"bg\")\n        this.question1 = bg.getChildByName(\"question1\")\n        this.question2 = bg.getChildByName(\"question2\")\n        this.winSize = cc.director.getWinSize()\n        this.animation = this.node.getComponent(cc.Animation)\n        this.node.setLocalZOrder(9999)\n    },\n\n    start () {\n        var self = this\n        this.initPlayerPos()\n        global.eventlistener.on(\"prepare\",function(){\n            self.runPrepareAction()\n        });\n        global.eventlistener.on(\"runForwardOrBackAction\",function(forward){\n            self.runForwardOrBackAction(forward)\n        });\n        global.eventlistener.on(\"runLeftOrRightAction\",function(right){\n            self.runLeftOrRightAction(right)\n        });\n    },\n    initPlayerPos:function(){\n        this.node.setPosition(-this.winSize.width/2 - 100,60 - this.winSize.height/2);\n    },\n    runPrepareAction:function(){\n        var self = this\n        var player_x = this.question1.x\n        var anim1 = cc.moveTo(1,player_x,-this.winSize.height/2 + 60)\n        var spawn = cc.spawn(anim1,cc.callFunc(function(){\n            self.animation.play(\"runRight\")\n        }))\n        var sequence = cc.sequence(spawn,cc.callFunc(function(){\n            self.animation.play(\"idle\")\n            global.eventlistener.fire(\"ready\")\n        }))\n        this.node.runAction(sequence)\n    },\n    runForwardOrBackAction:function(forward){\n        global.eventlistener.fire(\"enableOrUnenableBtn\",false)\n        var x_offset = this.question2.x - this.question1.x\n        var y_offset = this.question1.y + this.winSize.height/2\n        var direction_x_offset = x_offset\n        var self = this;\n        var action = cc.moveBy(2, 0, y_offset - 200);\n        var scaleAction = cc.scaleBy(2,0.7)\n        var sequence\n        if (forward){\n            //向前跑\n            var spawn = cc.spawn(action,scaleAction,cc.callFunc(function(){\n                self.animation.play(\"runForward\")\n            }))\n            sequence = cc.sequence(spawn,cc.callFunc(function(){\n                self.animation.play(\"idle\")\n                global.eventlistener.fire(\"runForwardEnd\")\n            }))\n        }else{\n            //向后跑\n            var spawn = cc.spawn(action.reverse(),scaleAction.reverse(),cc.callFunc(function(){\n                self.animation.play(\"runBack\")\n            }))\n\n            sequence = cc.sequence(spawn,cc.callFunc(function(){\n                self.runLeftOrRightAction(false)\n            }))\n        }\n        this.node.runAction(sequence);\n    },\n    runLeftOrRightAction:function(right){\n        global.eventlistener.fire(\"enableOrUnenableBtn\",false)\n        var x_offset = this.question2.x - this.question1.x\n        var y_offset = this.question1.y + this.winSize.height/2\n        var direction_x_offset = x_offset\n        var self = this;\n        //右跑\n        var action1 = cc.moveBy(0.7, direction_x_offset, 0);\n        var spawn1 = cc.spawn(action1,cc.callFunc(function(){\n            self.animation.play(\"runRight\")\n        }))\n        if(!right){\n            self.node.scaleX = -1 \n        }\n        var action2 = cc.moveBy(3.5,5 * -direction_x_offset,0)\n        var spawn2 = cc.spawn(action2,cc.callFunc(function(){\n            self.animation.play(\"runRight\")\n        }))\n        //序列动画（右跑）\n        var sequence = cc.sequence(spawn1,cc.callFunc(function(){\n            self.animation.play(\"idle\")\n            global.eventlistener.fire(\"runRightEnd\")\n            global.eventlistener.fire(\"enableOrUnenableBtn\",true)\n        }))\n        //序列动画（回到原点）\n        var sequence1 = cc.sequence(spawn2,cc.callFunc(function(){\n            global.eventlistener.fire(\"runLeftEnd\")\n            self.node.scaleX = 1 \n            self.animation.play(\"idle\")\n            // global.eventlistener.fire(\"enableOrUnenableBtn\",true)\n        }))\n        if (right){\n            this.node.runAction(sequence);\n        }else{\n            this.node.runAction(sequence1);\n        }\n    },\n    // update (dt) {\n       \n    // },\n});\n"]}