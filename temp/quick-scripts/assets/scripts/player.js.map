{"version":3,"sources":["player.js"],"names":["global","require","cc","Class","extends","Component","properties","onLoad","world","find","bg","getChildByName","question1","question2","winSize","director","getWinSize","animation","node","getComponent","Animation","setLocalZOrder","start","self","initPlayerPos","eventlistener","on","isRight","runWalkAction","runPrepareAction","forward","runForwardOrBackAction","right","runLeftOrRightAction","setPosition","width","height","player_x","x","anim1","moveTo","spawn","callFunc","play","sequence","fire","runAction","x_offset","y_offset","y","direction_x_offset","action","moveBy","scaleAction","scaleBy","reverse","action1","spawn1","scaleX","action2","spawn2","sequence1"],"mappings":"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","file":"player.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\nvar global = require(\"./global\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // player: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type:cc.Prefab, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        var world = cc.find(\"Canvas\")\n        var bg = world.getChildByName(\"bg\")\n        this.question1 = bg.getChildByName(\"question1\")\n        this.question2 = bg.getChildByName(\"question2\")\n        this.winSize = cc.director.getWinSize()\n        this.animation = this.node.getComponent(cc.Animation)\n        this.node.setLocalZOrder(9999)\n    },\n\n    start () {\n        var self = this\n        this.initPlayerPos()\n        global.eventlistener.on(\"runWalkAction\",function(isRight){\n            self.runWalkAction(isRight)\n        });\n        global.eventlistener.on(\"prepare\",function(){\n            self.runPrepareAction()\n        });\n        global.eventlistener.on(\"runForwardOrBackAction\",function(forward){\n            self.runForwardOrBackAction(forward)\n        });\n        global.eventlistener.on(\"runLeftOrRightAction\",function(right){\n            self.runLeftOrRightAction(right)\n        });\n    },\n    initPlayerPos:function(){\n        this.node.setPosition(-this.winSize.width/2 - 100,60 - this.winSize.height/2);\n    },\n    runPrepareAction:function(){\n        var self = this\n        var player_x = this.question1.x\n        var anim1 = cc.moveTo(1,player_x,-this.winSize.height/2 + 60)\n        var spawn = cc.spawn(anim1,cc.callFunc(function(){\n            self.animation.play(\"runRight\")\n        }))\n        var sequence = cc.sequence(spawn,cc.callFunc(function(){\n            self.animation.play(\"idle\")\n            global.eventlistener.fire(\"ready\")\n        }))\n        this.node.runAction(sequence)\n    },\n    runForwardOrBackAction:function(forward){\n        global.eventlistener.fire(\"enableOrUnenableBtn\",false)\n        var x_offset = this.question2.x - this.question1.x\n        var y_offset = this.question1.y + this.winSize.height/2\n        var direction_x_offset = x_offset\n        var self = this;\n        var action = cc.moveBy(2, 0, y_offset - 200);\n        var scaleAction = cc.scaleBy(2,0.7)\n        var sequence\n        if (forward){\n            //向前跑\n            var spawn = cc.spawn(action,scaleAction,cc.callFunc(function(){\n                self.animation.play(\"runForward\")\n            }))\n            sequence = cc.sequence(spawn,cc.callFunc(function(){\n                self.animation.play(\"idle\")\n                global.eventlistener.fire(\"runForwardEnd\")\n            }))\n        }else{\n            //向后跑\n            var spawn = cc.spawn(action.reverse(),scaleAction.reverse(),cc.callFunc(function(){\n                self.animation.play(\"runBack\")\n            }))\n\n            sequence = cc.sequence(spawn,cc.callFunc(function(){\n                self.runLeftOrRightAction(false)\n            }))\n        }\n        this.node.runAction(sequence);\n    },\n    runLeftOrRightAction:function(right){\n        global.eventlistener.fire(\"enableOrUnenableBtn\",false)\n        var x_offset = this.question2.x - this.question1.x\n        var y_offset = this.question1.y + this.winSize.height/2\n        var direction_x_offset = x_offset\n        var self = this;\n        //右跑\n        var action1 = cc.moveBy(0.7, direction_x_offset, 0);\n        var spawn1 = cc.spawn(action1,cc.callFunc(function(){\n            self.animation.play(\"runRight\")\n        }))\n        if(!right){\n            self.node.scaleX = -1 \n        }\n        var action2 = cc.moveBy(3.5,5 * -direction_x_offset,0)\n        var spawn2 = cc.spawn(action2,cc.callFunc(function(){\n            self.animation.play(\"runRight\")\n        }))\n        //序列动画（右跑）\n        var sequence = cc.sequence(spawn1,cc.callFunc(function(){\n            self.animation.play(\"idle\")\n            global.eventlistener.fire(\"runRightEnd\")\n            global.eventlistener.fire(\"enableOrUnenableBtn\",true)\n        }))\n        //序列动画（回到原点）\n        var sequence1 = cc.sequence(spawn2,cc.callFunc(function(){\n            global.eventlistener.fire(\"runLeftEnd\")\n            self.node.scaleX = 1 \n            self.animation.play(\"idle\")\n            // global.eventlistener.fire(\"enableOrUnenableBtn\",true)\n        }))\n        if (right){\n            this.node.runAction(sequence);\n        }else{\n            this.node.runAction(sequence1);\n        }\n    },\n    // update (dt) {\n       \n    // },\n});\n"]}